<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <link href="css/video-scroll.css" rel="stylesheet">
  <title>Media Carousel with Video Border Progress</title>
  <style>
    :root {
      --custom-media-width: 400px;
      --custom-media-height: 300px;
      --border-thickness: 4px;
    }

    #custom-media-carousel-wrapper {
      width: var(--custom-media-width);
      margin: 20px auto;
      overflow: hidden;
      position: relative;
    }

    #custom-carousel-inner {
      display: flex;
      transition: transform 0.5s ease-in-out;
    }

    .custom-media-item {
      flex: 0 0 var(--custom-media-width);
      height: var(--custom-media-height);
      position: relative;
      display: flex;
      justify-content: center;
      align-items: center;
    }

    .custom-media-item img,
    .custom-media-item video {
      width: var(--custom-media-width);
      height: var(--custom-media-height);
      object-fit: cover;
      border-radius: 12px;
      background: black;
    }

    .custom-video-wrapper {
      position: relative;
      width: 100%;
      height: 100%;
    }

    .custom-mute-button {
      position: absolute;
      top: 10px;
      right: 10px;
      z-index: 2;
      background: rgba(0, 0, 0, 0.6);
      color: #fff;
      border: none;
      border-radius: 50%;
      padding: 6px 10px;
      font-size: 16px;
      display: none;
      cursor: pointer;
    }

    .custom-media-item.video-active .custom-mute-button {
      display: block;
    }

    #custom-carousel-dots {
      margin-top: 10px;
      display: flex;
      justify-content: center;
      gap: 10px;
    }

    #custom-carousel-dots .dot {
      width: 22px;
      height: 22px;
      background: #555;
      border-radius: 50%;
      color: #ddd;
      font-size: 12px;
      text-align: center;
      line-height: 22px;
      cursor: pointer;
      transition: all 0.3s ease;
      user-select: none;
    }

    #custom-carousel-dots .dot.active {
      background: #fff;
      color: #000;
      font-weight: bold;
      width: 28px;
      height: 28px;
      font-size: 14px;
      line-height: 28px;
    }

    /* Border progress styles */
    .border-segment {
      position: absolute;
      background-color: red;
      z-index: 1;
    }

    .v-top,
    .v-bottom {
      height: var(--border-thickness);
      width: 0;
    }

    .v-left,
    .v-right {
      width: var(--border-thickness);
      height: 0;
    }

    .v-top {
      top: 0;
      left: 0;
    }

    .v-right {
      top: 0;
      right: 0;
    }

    .v-bottom {
      bottom: 0;
      right: 0;
    }

    .v-left {
      bottom: 0;
      left: 0;
    }
  </style>
</head>
<body>

<div id="custom-media-carousel-wrapper">
  <div id="custom-carousel-inner">
    <div class="custom-media-item">
      <img src="img/indy-durga-2021.jpg" alt="Image 1" />
    </div>
    <div class="custom-media-item">
      <img src="img/ns/ns1.jpg" alt="Image 2" />
    </div>
    <div class="custom-media-item">
      <div class="custom-video-wrapper">
        <video muted playsinline>
          <source src="img/ns/ns3.mp4" type="video/mp4" />
        </video>
        <div class="border-segment v-top"></div>
        <div class="border-segment v-right"></div>
        <div class="border-segment v-bottom"></div>
        <div class="border-segment v-left"></div>
        <button class="custom-mute-button">ðŸ”‡</button>
      </div>
    </div>
    <div class="custom-media-item">
      <img src="img/ns/ns2.jpg" alt="Image 2" />
    </div>
    <div class="custom-media-item">
      <div class="custom-video-wrapper">
        <video muted playsinline>
          <source src="img/ns/ns4.mp4" type="video/mp4" />
        </video>
        <div class="border-segment v-top"></div>
        <div class="border-segment v-right"></div>
        <div class="border-segment v-bottom"></div>
        <div class="border-segment v-left"></div>
        <button class="custom-mute-button">ðŸ”‡</button>
      </div>
    </div>
  </div>
  <div id="custom-carousel-dots"></div>
</div>

<script>
function updateBorderProgress(video, wrapper) {
  const top = wrapper.querySelector('.v-top');
  const right = wrapper.querySelector('.v-right');
  const bottom = wrapper.querySelector('.v-bottom');
  const left = wrapper.querySelector('.v-left');

  const width = video.offsetWidth;
  const height = video.offsetHeight;
  const perimeter = 2 * (width + height);

  function animate() {
    if (!video.paused && !video.ended) {
      const percent = (video.currentTime / video.duration) * 100;
      const progressPx = (percent / 100) * perimeter;
      let remaining = progressPx;

      top.style.width = `${Math.min(remaining, width)}px`;
      remaining -= Math.min(remaining, width);

      right.style.height = `${Math.min(remaining, height)}px`;
      remaining -= Math.min(remaining, height);

      bottom.style.width = `${Math.min(remaining, width)}px`;
      remaining -= Math.min(remaining, width);

      left.style.height = `${Math.min(remaining, height)}px`;
      requestAnimationFrame(animate);
    }
  }
  animate();
}

function initMediaCarousel(mediaWidth, mediaHeight, imageDelay) {
  document.documentElement.style.setProperty('--custom-media-width', mediaWidth + 'px');
  document.documentElement.style.setProperty('--custom-media-height', mediaHeight + 'px');

  const container = document.getElementById('custom-carousel-inner');
  const items = container.querySelectorAll('.custom-media-item');
  const dotsContainer = document.getElementById('custom-carousel-dots');
  let currentIndex = 0;
  let timeout = null;

  dotsContainer.innerHTML = '';
  items.forEach((_, i) => {
    const dot = document.createElement('div');
    dot.className = 'dot';
    dot.textContent = i + 1;
    dot.addEventListener('click', () => {
      clearTimeout(timeout);
      showItem(i);
    });
    dotsContainer.appendChild(dot);
  });
  const dots = dotsContainer.querySelectorAll('.dot');

  function showItem(index) {
    if (index >= items.length) index = 0;
    currentIndex = index;

    container.style.transform = `translateX(-${index * mediaWidth}px)`;
    dots.forEach(dot => dot.classList.remove('active'));
    dots[index].classList.add('active');

    items.forEach(item => {
      item.classList.remove('video-active');
      const video = item.querySelector('video');
      if (video) {
        video.pause();
        video.currentTime = 0;
      }
    });

    const currentItem = items[index];
    const media = currentItem.querySelector('img, video');

    if (media.tagName === 'IMG') {
      timeout = setTimeout(() => showItem(index + 1), imageDelay);
    } else if (media.tagName === 'VIDEO') {
      currentItem.classList.add('video-active');
      media.play().then(() => {
        updateBorderProgress(media, media.parentElement);
        media.onended = () => showItem(index + 1);
      }).catch(() => {
        timeout = setTimeout(() => showItem(index + 1), imageDelay);
      });
    }
  }

  document.querySelectorAll('.custom-mute-button').forEach(button => {
    button.addEventListener('click', () => {
      const video = button.previousElementSibling;
      video.muted = !video.muted;
      button.textContent = video.muted ? 'ðŸ”‡' : 'ðŸ”Š';
    });
  });

  showItem(0);
}

window.addEventListener('DOMContentLoaded', () => {
  initMediaCarousel(400, 300, 6000);
});
</script>

</body>
</html>
